package sist.com.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

import sist.com.model.EmpBean;
import sist.com.util.ServiceUtil;

public class ScottDao {
	
	public static EmpBean selectEmpInfo(int empno) {
		StringBuffer sb=new StringBuffer();
		sb.append("SELECT EMPNO,ENAME,JOB,MGR,TO_CHAR(HIREDATE,'YYYY')HIREDATE, ")
		  .append("SAL,NVL(COMM,0)COMM ")
		  .append("FROM EMP ")
		  .append("WHERE EMPNO=?");
		 Connection con=null;
		 PreparedStatement pstmt=null;
		 ResultSet rs=null;
		 EmpBean bean=new EmpBean();
		 
		 try {
			 con=ServiceUtil.getConnection();
			 pstmt=con.prepareStatement(sb.toString());
			 pstmt.setInt(1, empno);
			 rs=pstmt.executeQuery();
			 if(rs.next()) {
				 
				 bean.setEmpno(rs.getInt(1));
				 bean.setEname(rs.getString(2));
				 bean.setJob(rs.getString(3));
				 bean.setMgr(rs.getInt(4));
				 bean.setHiredate(rs.getString(5));
				 bean.setSal(rs.getInt(6));
				 bean.setComm(rs.getInt(7));				 
			 }
			
		} catch (Exception e) {
			// TODO: handle exception
			e.printStackTrace();
		}finally {
			try {
				con.close();
				pstmt.close();
			} catch (Exception e2) {
				// TODO: handle exception
			}
		}
		 return bean;
		  
	}
	public static List<EmpBean>selectEmp(HashMap<String, Object>map){
		StringBuffer sb=new StringBuffer();
		ArrayList<EmpBean>list=new ArrayList<EmpBean>();
		sb.append("SELECT EMPNO,ENAME,JOB,MGR,TO_CHAR(HIREDATE,'YYYY')HIREDATE, ")
		  .append("SAL,NVL(COMM,0)COMM,DEPTNO,ROWNUM rm ")
		  .append("FROM EMP ");
		if(map!=null) {
		  sb.append("WHERE "+map.get("query")+" LIKE '%"+map.get("data")+"%'");	
		}
		 Connection con=null;
		 PreparedStatement pstmt=null;
		 ResultSet rs=null;
		 
		 try {
			 con=ServiceUtil.getConnection();
			 pstmt=con.prepareStatement(sb.toString());
			 rs=pstmt.executeQuery();
			 while(rs.next()) {
				 EmpBean bean=new EmpBean();
				 bean.setRm(rs.getInt(9));
				 bean.setEmpno(rs.getInt(1));
				 bean.setEname(rs.getString(2));
				 bean.setJob(rs.getString(3));
				 bean.setMgr(rs.getInt(4));
				 bean.setHiredate(rs.getString(5));
				 bean.setSal(rs.getInt(6));
				 bean.setComm(rs.getInt(7));
				 bean.setDeptno(rs.getInt(8));
				 list.add(bean);
			 }			 
			
		} catch (Exception e) {
			// TODO: handle exception
			e.printStackTrace();
		}finally {
			try {
				con.close();
				pstmt.close();				
			} catch (Exception e2) {
				// TODO: handle exception
			}
		}
			
		
		return list;
	}
	

}









